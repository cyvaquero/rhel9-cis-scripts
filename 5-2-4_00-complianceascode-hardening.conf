# 5.2.4 Ensure SSH access is limited
# Filepath: /etc/ssh/sshd_config.d/00-complianceascode-hardening.conf

PermitRootLogin no
AllowTcpForwarding no
LogLevel VERBOSE

# RHEL9 CIS Benchmark Policy settings
AddressFamily inet
ClientAliveCountMax 0
#LoginGraceTime 60
MaxAuthTries 4
MaxSessions 10
MaxStartups 10:30:60

# Manual CIS Benchmark settings
## 5.2.4 Ensure SSH access is limited
AllowGroups sshusers

## 5.2.15 Ensure SSH warning banner is configured
Banner /etc/issue

## 5.2.20 Ensure SSH Idle Timeout Interval is configured
ClientAliveInterval 3540
ClientAliveCountMax 0

00-complianceascode-hardening.conf